var WX_selectedRowBgcolor='#3297FD';var WXConfig=new Object();WXConfig.showreport_url='/hilltop/ShowReport.wx';WXConfig.showreport_onpage_url='/hilltop/ShowReport.wx?DISPLAY_TYPE=1';WXConfig.webroot='/hilltop/';WXConfig.prompt_dialog_type='artdialog';WXConfig.load_error_message='<strong>系统忙，请稍后再试！</strong>';function getInputBoxValue(boxObj){  if(boxObj==null) return null;  var boxId=getInputboxIdByParentElementObj(getInputboxParentElementObj(boxObj));  if(boxId==null||boxId=='') return null;  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return null;  var boxType=boxMetadataObj.getAttribute('typename');  if(boxType=='combox')  {    if(boxObj==null) return null;var valObjTmp=getComboxLabelValue(boxObj);if(valObjTmp==null) return null;return valObjTmp.value;  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    var radioObjs=document.getElementsByName(boxId);if(radioObjs==null||radioObjs.length==0) return null;for(i=0;i<radioObjs.length;i=i+1){  if(radioObjs[i].checked){   return radioObjs[i].value;   }}  return null;  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    if(boxObj==null) return null;if(boxObj.options.length==0) return null;var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') return boxObj.options[boxObj.options.selectedIndex].value;var resultVal='';for(var i=0,len=boxObj.options.length;i<len;i++){  if(boxObj.options[i].selected){resultVal=resultVal+boxObj.options[i].value+separator;}}return wx_rtrim(resultVal,separator);  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return null;return boxObj.tagName=='IMG'?boxObj.getAttribute('srcpath'):boxObj.value;  }  if(boxType=='checkbox')  {    var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return '';var value=''; var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') separator=' ';for(i=0,len=chkObjs.length;i<len;i=i+1){    if(chkObjs[i].checked){        value+=chkObjs[i].value+separator;    }}return wx_rtrim(value,separator);  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    return tinyMCE.get(boxId).getContent();  }return boxObj==null?null:boxObj.value;}function getInputBoxLabel(boxObj){  if(boxObj==null) return null;  var boxId=getInputboxIdByParentElementObj(getInputboxParentElementObj(boxObj));  if(boxId==null||boxId=='') return null;  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return null;  var boxType=boxMetadataObj.getAttribute('typename');  if(boxType=='combox')  {    if(boxObj==null) return null;var valObjTmp=getComboxLabelValue(boxObj);if(valObjTmp==null) return null;return valObjTmp.label;  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    var radioObjs=document.getElementsByName(boxId);if(radioObjs==null||radioObjs.length==0) return null;for(i=0;i<radioObjs.length;i=i+1){  if(radioObjs[i].checked){   return radioObjs[i].getAttribute('label');   }}  return null;  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    if(boxObj==null) return null;if(boxObj.options.length==0) return null;var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') return boxObj.options[boxObj.options.selectedIndex].text;var resultVal='';for(var i=0,len=boxObj.options.length;i<len;i++){  if(boxObj.options[i].selected){resultVal=resultVal+boxObj.options[i].text+separator;}}return wx_rtrim(resultVal,separator);  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return null;return boxObj.tagName=='IMG'?boxObj.getAttribute('srcpath'):boxObj.value;  }  if(boxType=='checkbox')  {    var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return '';var value=''; var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') separator=' ';for(i=0,len=chkObjs.length;i<len;i=i+1){    if(chkObjs[i].checked){        value+=chkObjs[i].getAttribute('label')+separator;    }}return wx_rtrim(value,separator);  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    return tinyMCE.get(boxId).getContent();  }return boxObj==null?null:boxObj.value;}function getInputBoxValueById(boxId){  if(boxId==null||boxId=='') return null;  var boxObj=document.getElementById(boxId);  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return null;  var boxType=boxMetadataObj.getAttribute('typename');  if(boxType=='combox')  {    if(boxObj==null) return null;var valObjTmp=getComboxLabelValue(boxObj);if(valObjTmp==null) return null;return valObjTmp.value;  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    var radioObjs=document.getElementsByName(boxId);if(radioObjs==null||radioObjs.length==0) return null;for(i=0;i<radioObjs.length;i=i+1){  if(radioObjs[i].checked){   return radioObjs[i].value;   }}  return null;  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    if(boxObj==null) return null;if(boxObj.options.length==0) return null;var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') return boxObj.options[boxObj.options.selectedIndex].value;var resultVal='';for(var i=0,len=boxObj.options.length;i<len;i++){  if(boxObj.options[i].selected){resultVal=resultVal+boxObj.options[i].value+separator;}}return wx_rtrim(resultVal,separator);  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return null;return boxObj.tagName=='IMG'?boxObj.getAttribute('srcpath'):boxObj.value;  }  if(boxType=='checkbox')  {    var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return '';var value=''; var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') separator=' ';for(i=0,len=chkObjs.length;i<len;i=i+1){    if(chkObjs[i].checked){        value+=chkObjs[i].value+separator;    }}return wx_rtrim(value,separator);  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    return tinyMCE.get(boxId).getContent();  }return boxObj==null?null:boxObj.value;}function getInputBoxLabelById(boxId){  if(boxId==null||boxId=='') return null;  var boxObj=document.getElementById(boxId);  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return null;  var boxType=boxMetadataObj.getAttribute('typename');  if(boxType=='combox')  {    if(boxObj==null) return null;var valObjTmp=getComboxLabelValue(boxObj);if(valObjTmp==null) return null;return valObjTmp.label;  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    var radioObjs=document.getElementsByName(boxId);if(radioObjs==null||radioObjs.length==0) return null;for(i=0;i<radioObjs.length;i=i+1){  if(radioObjs[i].checked){   return radioObjs[i].getAttribute('label');   }}  return null;  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    if(boxObj==null) return null;if(boxObj.options.length==0) return null;var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') return boxObj.options[boxObj.options.selectedIndex].text;var resultVal='';for(var i=0,len=boxObj.options.length;i<len;i++){  if(boxObj.options[i].selected){resultVal=resultVal+boxObj.options[i].text+separator;}}return wx_rtrim(resultVal,separator);  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return null;return boxObj.tagName=='IMG'?boxObj.getAttribute('srcpath'):boxObj.value;  }  if(boxType=='checkbox')  {    var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return '';var value=''; var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') separator=' ';for(i=0,len=chkObjs.length;i<len;i=i+1){    if(chkObjs[i].checked){        value+=chkObjs[i].getAttribute('label')+separator;    }}return wx_rtrim(value,separator);  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    return tinyMCE.get(boxId).getContent();  }return boxObj==null?null:boxObj.value;}function setInputBoxValue(boxObj,newValue){  if(boxObj==null) return;  var boxId=getInputboxIdByParentElementObj(getInputboxParentElementObj(boxObj));  if(boxId==null||boxId=='') return;  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return;  var boxType=boxMetadataObj.getAttribute('typename');  var isCommonFlag=true;  if(boxType=='combox')  {    isCommonFlag=false;if(boxObj==null) return;setComboxValue(boxObj,newValue,newValue);  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    isCommonFlag=false;var radioObjs=document.getElementsByName(boxId);if(radioObjs!=null&&radioObjs.length>0){  for(var i=0,len=radioObjs.length;i<len;i=i+1){      if(radioObjs[i].value==newValue){radioObjs[i].checked=true;break;}  }}  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    isCommonFlag=false;if(boxObj==null||boxObj.options.length==0) return;var separator=boxMetadataObj.getAttribute('separator');if(separator!=null&&separator!=''){  for(var j=0,len=boxObj.options.length;j<len;j++){      if(boxObj.options[j].selected&&boxObj.options[j].value==newValue) return;  }}else{  var oldvalue=boxObj.options[boxObj.selectedIndex].value;  if(oldvalue&&oldvalue==newValue) return;}var i=0;for(len=boxObj.options.length;i<len;i=i+1){  if(boxObj.options[i].value==newValue){boxObj.options[i].selected=true;break;}}if(i!=boxObj.options.length&&boxObj.onchange){boxObj.onchange();}  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return;isCommonFlag=false;if(boxObj.tagName=='IMG'){boxObj.setAttribute('srcpath',newValue);boxObj.src=newValue;}else{boxObj.value=newValue;}  }  if(boxType=='checkbox')  {    isCommonFlag=false;var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return;for(var i=0,len=chkObjs.length;i<len;i=i+1){  if(isSelectedValueForSelectedBox(newValue,chkObjs[i].value,boxMetadataObj)){chkObjs[i].checked=true;}}  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    isCommonFlag=false;tinyMCE.get(boxId).setContent(newValue);  }  if(isCommonFlag==true){      if(boxObj!=null){boxObj.value=newValue;}  }}function setInputBoxLabel(boxObj,newValue){  if(boxObj==null) return;  var boxId=getInputboxIdByParentElementObj(getInputboxParentElementObj(boxObj));  if(boxId==null||boxId=='') return;  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return;  var boxType=boxMetadataObj.getAttribute('typename');  var isCommonFlag=true;  if(boxType=='combox')  {    isCommonFlag=false;if(boxObj==null) return;setComboxLabel(boxObj,newValue);  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    isCommonFlag=false;var radioObjs=document.getElementsByName(boxId);if(radioObjs!=null&&radioObjs.length>0){  for(var i=0,len=radioObjs.length;i<len;i=i+1){      if(radioObjs[i].getAttribute('label')==newValue){radioObjs[i].checked=true;break;}  }}  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    isCommonFlag=false;if(boxObj==null||boxObj.options.length==0) return;var separator=boxMetadataObj.getAttribute('separator');if(separator!=null&&separator!=''){  for(var j=0,len=boxObj.options.length;j<len;j++){      if(boxObj.options[j].selected&&boxObj.options[j].text==newValue) return;  }}else{  var oldvalue=boxObj.options[boxObj.selectedIndex].text;  if(oldvalue&&oldvalue==newValue) return;}var i=0;for(len=boxObj.options.length;i<len;i=i+1){  if(boxObj.options[i].text==newValue){boxObj.options[i].selected=true;break;}}if(i!=boxObj.options.length&&boxObj.onchange){boxObj.onchange();}  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return;isCommonFlag=false;if(boxObj.tagName=='IMG'){boxObj.setAttribute('srcpath',newValue);boxObj.src=newValue;}else{boxObj.value=newValue;}  }  if(boxType=='checkbox')  {    isCommonFlag=false;var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return;for(var i=0,len=chkObjs.length;i<len;i=i+1){  if(isSelectedValueForSelectedBox(newValue,chkObjs[i].getAttribute('label'),boxMetadataObj)){chkObjs[i].checked=true;}}  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    isCommonFlag=false;tinyMCE.get(boxId).setContent(newValue);  }  if(isCommonFlag==true){      if(boxObj!=null){boxObj.value=newValue;}  }}function setInputBoxValueById(boxId,newValue){  if(boxId==null||boxId=='') return;  var boxObj=document.getElementById(boxId);  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return;  var boxType=boxMetadataObj.getAttribute('typename');  var isCommonFlag=true;  if(boxType=='combox')  {    isCommonFlag=false;if(boxObj==null) return;setComboxValue(boxObj,newValue,newValue);  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    isCommonFlag=false;var radioObjs=document.getElementsByName(boxId);if(radioObjs!=null&&radioObjs.length>0){  for(var i=0,len=radioObjs.length;i<len;i=i+1){      if(radioObjs[i].value==newValue){radioObjs[i].checked=true;break;}  }}  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    isCommonFlag=false;if(boxObj==null||boxObj.options.length==0) return;var separator=boxMetadataObj.getAttribute('separator');if(separator!=null&&separator!=''){  for(var j=0,len=boxObj.options.length;j<len;j++){      if(boxObj.options[j].selected&&boxObj.options[j].value==newValue) return;  }}else{  var oldvalue=boxObj.options[boxObj.selectedIndex].value;  if(oldvalue&&oldvalue==newValue) return;}var i=0;for(len=boxObj.options.length;i<len;i=i+1){  if(boxObj.options[i].value==newValue){boxObj.options[i].selected=true;break;}}if(i!=boxObj.options.length&&boxObj.onchange){boxObj.onchange();}  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return;isCommonFlag=false;if(boxObj.tagName=='IMG'){boxObj.setAttribute('srcpath',newValue);boxObj.src=newValue;}else{boxObj.value=newValue;}  }  if(boxType=='checkbox')  {    isCommonFlag=false;var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return;for(var i=0,len=chkObjs.length;i<len;i=i+1){  if(isSelectedValueForSelectedBox(newValue,chkObjs[i].value,boxMetadataObj)){chkObjs[i].checked=true;}}  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    isCommonFlag=false;tinyMCE.get(boxId).setContent(newValue);  }  if(isCommonFlag==true){      if(boxObj!=null){boxObj.value=newValue;}  }}function setInputBoxLabelById(boxId,newValue){  if(boxId==null||boxId=='') return;  var boxObj=document.getElementById(boxId);  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return;  var boxType=boxMetadataObj.getAttribute('typename');  var isCommonFlag=true;  if(boxType=='combox')  {    isCommonFlag=false;if(boxObj==null) return;setComboxLabel(boxObj,newValue);  }  if(boxType=='datepicker')  {      }  if(boxType=='radiobox')  {    isCommonFlag=false;var radioObjs=document.getElementsByName(boxId);if(radioObjs!=null&&radioObjs.length>0){  for(var i=0,len=radioObjs.length;i<len;i=i+1){      if(radioObjs[i].getAttribute('label')==newValue){radioObjs[i].checked=true;break;}  }}  }  if(boxType=='customized')  {      }  if(boxType=='selectbox')  {    isCommonFlag=false;if(boxObj==null||boxObj.options.length==0) return;var separator=boxMetadataObj.getAttribute('separator');if(separator!=null&&separator!=''){  for(var j=0,len=boxObj.options.length;j<len;j++){      if(boxObj.options[j].selected&&boxObj.options[j].text==newValue) return;  }}else{  var oldvalue=boxObj.options[boxObj.selectedIndex].text;  if(oldvalue&&oldvalue==newValue) return;}var i=0;for(len=boxObj.options.length;i<len;i=i+1){  if(boxObj.options[i].text==newValue){boxObj.options[i].selected=true;break;}}if(i!=boxObj.options.length&&boxObj.onchange){boxObj.onchange();}  }  if(boxType=='datepicker2')  {      }  if(boxType=='textbox')  {      }  if(boxType=='textareabox')  {      }  if(boxType=='passwordbox')  {      }  if(boxType=='file')  {    if(boxObj==null) return;isCommonFlag=false;if(boxObj.tagName=='IMG'){boxObj.setAttribute('srcpath',newValue);boxObj.src=newValue;}else{boxObj.value=newValue;}  }  if(boxType=='checkbox')  {    isCommonFlag=false;var chkObjs=document.getElementsByName(boxId);if(chkObjs==null||chkObjs.length==0) return;for(var i=0,len=chkObjs.length;i<len;i=i+1){  if(isSelectedValueForSelectedBox(newValue,chkObjs[i].getAttribute('label'),boxMetadataObj)){chkObjs[i].checked=true;}}  }  if(boxType=='popupbox')  {      }  if(boxType=='richtextbox')  {    isCommonFlag=false;tinyMCE.get(boxId).setContent(newValue);  }  if(isCommonFlag==true){      if(boxObj!=null){boxObj.value=newValue;}  }}function getChangeStyleObjByInputBoxObjOnEdit(boxObj){  var parentEleObj=getInputboxParentElementObj(boxObj);  if(parentEleObj==null) return boxObj;  if(parentEleObj.changeStyleObjByInputBoxObjOnEdit!=null) return parentEleObj.changeStyleObjByInputBoxObjOnEdit;  var boxId=getInputboxIdByParentElementObj(parentEleObj);  if(boxId==null||boxId=='') return boxObj;  var boxMetadataObj=getInputboxMetadataObj(boxId);if(boxMetadataObj==null) return boxObj;  var boxType=boxMetadataObj.getAttribute('typename');  if(boxType=='combox'){  boxObj=getTextBoxObjOfCombox(boxObj);  }  if(boxType=='datepicker'){    }  if(boxType=='radiobox'){  var optBoxName=boxObj.getAttribute('name');boxObj=boxObj.parentNode;while(boxObj!=null){  if(boxObj.tagName=='SPAN'&&boxObj.getAttribute('id')==optBoxName+'_group') break;  boxObj=boxObj.parentNode;}  }  if(boxType=='customized'){    }  if(boxType=='selectbox'){    }  if(boxType=='datepicker2'){    }  if(boxType=='textbox'){    }  if(boxType=='textareabox'){    }  if(boxType=='passwordbox'){    }  if(boxType=='file'){  var displaytype=boxMetadataObj.getAttribute('displaytype');if(displaytype=='image'){  boxObj=boxObj.parentNode;  while(boxObj!=null&&boxObj.tagName=='FONT'){boxObj=boxObj.parentNode;}}  }  if(boxType=='checkbox'){  var optBoxName=boxObj.getAttribute('name');boxObj=boxObj.parentNode;while(boxObj!=null){  if(boxObj.tagName=='SPAN'&&boxObj.getAttribute('id')==optBoxName+'_group') break;  boxObj=boxObj.parentNode;}  }  if(boxType=='popupbox'){    }  if(boxType=='richtextbox'){    }return boxObj;}function fillInputBoxToTd(parentTdObj){   var realinputboxid=getInputboxIdByParentElementObj(parentTdObj);   var reportguid=getReportGuidByInputboxId(realinputboxid);   var metadataObj=getReportMetadataObj(reportguid);   var reportfamily=metadataObj.reportfamily;   var textalign=parentTdObj.style.textAlign||parentTdObj.getAttribute('align'); if(textalign==null) textalign='left';   var wid=parentTdObj.clientWidth-2;   var updateDestTdObj=getUpdateColDestObj(parentTdObj,reportguid,parentTdObj);   var boxValue=updateDestTdObj.getAttribute('value');   if(boxValue==null){boxValue='';}   var boxMetadataObj=getInputboxMetadataObj(realinputboxid);   if(boxMetadataObj==null){ wx_error('没有取到输入框'+realinputboxid+'对应的元数据，无法显示输入框');return;}   var displayonclick=boxMetadataObj.getAttribute('displayonclick');   var boxType=boxMetadataObj.getAttribute('typename');   var styleproperty=boxMetadataObj.getAttribute('styleproperty');   if(styleproperty==null) styleproperty='';styleproperty=paramdecode(styleproperty);   var boxstr='';var arrTmp=null;  if(boxType=='combox'){  boxstr="<select ";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}boxstr=boxstr+" "+styleproperty;boxstr+=">";boxstr+="</select>";setColDisplayValueToEditable2Td(parentTdObj,boxstr);showComboxAddOptionsById(realinputboxid);if(displayonclick==='true'){  var parentIds=boxMetadataObj.getAttribute('parentids');  if(parentIds!=null&&parentIds!=''){wx_reloadChildSelectBoxOptions(realinputboxid,false);}}  }  if(boxType=='datepicker'){   boxstr="<input type='text' value=\""+boxValue+"\"";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}var typePrompt=boxMetadataObj.getAttribute('typePrompt');if(typePrompt!=null&&typePrompt!=''){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'onfocus');  arrTmp[1]=wx_trim(arrTmp[1]);if(arrTmp[1]!=''&&arrTmp[1].lastIndexOf(';')!=arrTmp[1].length-1) arrTmp[1]=arrTmp[1]+';';  arrTmp[1]=arrTmp[1]+"initializeTypePromptProperties(this,'"+typePrompt+"');";  styleproperty=arrTmp[0]+" onfocus=\""+arrTmp[1]+"\"";}boxstr=boxstr+" "+styleproperty;boxstr+=">";setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='radiobox'){  var parentIds=boxMetadataObj.getAttribute('parentids');if(parentIds!=null&&parentIds!=''){  if(displayonclick==='true'){      wx_reloadChildSelectBoxOptions(realinputboxid,false);  }else{      setColDisplayValueToEditable2Td(parentTdObj,"<span id='"+realinputboxid+"_group'></span>");  }}else{  boxstr=getChkRadioBoxOptionsDisplayString(boxMetadataObj,getSelectBoxOptionsFromMetadata(boxMetadataObj),realinputboxid,boxValue,'radio');  setColDisplayValueToEditable2Td(parentTdObj,"<span id='"+realinputboxid+"_group'>"+boxstr+"</span>");}  }  if(boxType=='customized'){    }  if(boxType=='selectbox'){  boxstr="<select ";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}boxstr=boxstr+" "+styleproperty;boxstr+=">";var optionSpans=boxMetadataObj.getElementsByTagName("span");if(optionSpans!=null&&optionSpans.length>0){ var optionlabel=null;var optionvalue=null;  for(var i=0,len=optionSpans.length;i<len;i++){      optionlabel=optionSpans[i].getAttribute('label'); optionvalue=optionSpans[i].getAttribute('value');      boxstr=boxstr+"<option value='"+optionvalue+"'";      if(isSelectedValueForSelectedBox(boxValue,optionvalue,boxMetadataObj)) boxstr=boxstr+" selected";      boxstr=boxstr+">"+optionlabel+"</option>";  }}boxstr+="</select>";setColDisplayValueToEditable2Td(parentTdObj,boxstr);if(displayonclick==='true'){  var parentIds=boxMetadataObj.getAttribute('parentids');if(parentIds!=null&&parentIds!='') wx_reloadChildSelectBoxOptions(realinputboxid,false);}  }  if(boxType=='datepicker2'){   boxstr="<input type='text' value=\""+boxValue+"\"";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}var typePrompt=boxMetadataObj.getAttribute('typePrompt');if(typePrompt!=null&&typePrompt!=''){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'onfocus');  arrTmp[1]=wx_trim(arrTmp[1]);if(arrTmp[1]!=''&&arrTmp[1].lastIndexOf(';')!=arrTmp[1].length-1) arrTmp[1]=arrTmp[1]+';';  arrTmp[1]=arrTmp[1]+"initializeTypePromptProperties(this,'"+typePrompt+"');";  styleproperty=arrTmp[0]+" onfocus=\""+arrTmp[1]+"\"";}boxstr=boxstr+" "+styleproperty;boxstr+=">";setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='textbox'){   boxstr="<input type='text' value=\""+boxValue+"\"";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}var typePrompt=boxMetadataObj.getAttribute('typePrompt');if(typePrompt!=null&&typePrompt!=''){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'onfocus');  arrTmp[1]=wx_trim(arrTmp[1]);if(arrTmp[1]!=''&&arrTmp[1].lastIndexOf(';')!=arrTmp[1].length-1) arrTmp[1]=arrTmp[1]+';';  arrTmp[1]=arrTmp[1]+"initializeTypePromptProperties(this,'"+typePrompt+"');";  styleproperty=arrTmp[0]+" onfocus=\""+arrTmp[1]+"\"";}boxstr=boxstr+" "+styleproperty;boxstr+=">";setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='textareabox'){    boxstr="<textarea  ";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}boxstr=boxstr+" "+styleproperty;  boxstr=boxstr+">"+boxValue+"</textarea>";if(displayonclick=='true'){  var textAreaboxContainer=document.getElementById('WX_TEXTAREA_BOX_CONTAINER');  if(textAreaboxContainer==null){      textAreaboxContainer=document.createElement('span');      textAreaboxContainer.setAttribute('id','WX_TEXTAREA_BOX_CONTAINER');      document.body.appendChild(textAreaboxContainer);  }  textAreaboxContainer.innerHTML=boxstr;  textAreaboxContainer.style.display='';  var textAreabox=document.getElementById(realinputboxid);  setTextAreaBoxPosition(textAreabox,parentTdObj);  textAreabox.focus();}else{setColDisplayValueToEditable2Td(parentTdObj,boxstr);}  }  if(boxType=='passwordbox'){   boxstr="<input type='password' value=\""+boxValue+"\"";boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}var typePrompt=boxMetadataObj.getAttribute('typePrompt');if(typePrompt!=null&&typePrompt!=''){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'onfocus');  arrTmp[1]=wx_trim(arrTmp[1]);if(arrTmp[1]!=''&&arrTmp[1].lastIndexOf(';')!=arrTmp[1].length-1) arrTmp[1]=arrTmp[1]+';';  arrTmp[1]=arrTmp[1]+"initializeTypePromptProperties(this,'"+typePrompt+"');";  styleproperty=arrTmp[0]+" onfocus=\""+arrTmp[1]+"\"";}boxstr=boxstr+" "+styleproperty;boxstr+=">";setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='file'){  var displaytype=boxMetadataObj.getAttribute('displaytype');if(displaytype==null||displaytype=='') displaytype='textbox';if(displaytype=='image'){ var imgurl=boxValue;if(imgurl==null||imgurl=='') imgurl=WXConfig.webroot+'webresources/skin/nopicture.gif';  boxstr="<img alt=\"no picture\" src=\""+imgurl+"\" srcpath=\""+boxValue+"\"";}else{  boxstr="<input type='text' value=\""+boxValue+"\"";}boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displaytype!=='image'){if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}}boxstr=boxstr+" "+styleproperty;boxstr=boxstr+"/>";setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='checkbox'){  var parentIds=boxMetadataObj.getAttribute('parentids');if(parentIds!=null&&parentIds!=''){  if(displayonclick==='true'){      wx_reloadChildSelectBoxOptions(realinputboxid,false);  }else{      setColDisplayValueToEditable2Td(parentTdObj,"<span id='"+realinputboxid+"_group'></span>");  }}else{  boxstr=getChkRadioBoxOptionsDisplayString(boxMetadataObj,getSelectBoxOptionsFromMetadata(boxMetadataObj),realinputboxid,boxValue,'checkbox');  setColDisplayValueToEditable2Td(parentTdObj,"<span id='"+realinputboxid+"_group'>"+boxstr+"</span>");}  }  if(boxType=='popupbox'){  if(boxMetadataObj.getAttribute('sourcebox')=='textareabox'){boxstr="<textarea";}else{boxstr="<input type='text' value=\""+boxValue+"\"";}boxstr=boxstr+" id= '"+realinputboxid+"' name='"+realinputboxid+"'";if(styleproperty==null) styleproperty='';if(displayonclick==='true'||boxMetadataObj.getAttribute('displaynonstyle')=='true'){  arrTmp=getPropertyValueFromHtmlProperties(styleproperty,'style');  styleproperty=arrTmp[0];  var styleValue=arrTmp[1];if(styleValue==null) styleValue='';  if(styleValue.toLowerCase().indexOf('text-align:')<0) styleValue=styleValue+"text-align:"+textalign+";";  if(wid!=null&&parseInt(wid)>0&&styleValue.toLowerCase().indexOf('width:')<0){      styleValue=styleValue+"width:"+wid+"px;";}  styleproperty=" style=\""+styleValue+"\" "+arrTmp[0];}boxstr=boxstr+" "+styleproperty;boxstr=boxstr+">";if(boxMetadataObj.getAttribute('sourcebox')=='textareabox'){boxstr=boxstr+boxValue+"</textarea>";}setColDisplayValueToEditable2Td(parentTdObj,boxstr);  }  if(boxType=='richtextbox'){    }  doPostFilledInContainer(parentTdObj);}function doPostFilledInContainer(parentTdObj){  var realinputboxid=getInputboxIdByParentElementObj(parentTdObj);  var boxMetadataObj=getInputboxMetadataObj(realinputboxid);  var boxType=boxMetadataObj.getAttribute('typename');  var displayonclick=boxMetadataObj.getAttribute('displayonclick');  var isCommonFlag=true;  if(boxType=='combox'){    }  if(boxType=='datepicker'){    }  if(boxType=='radiobox'){  isCommonFlag=false;var boxObjsArr=document.getElementsByName(realinputboxid);if(boxObjsArr==null||boxObjsArr.length==0) return;if(displayonclick=='true'){for(var j=0;j<boxObjsArr.length;j++){boxObjsArr[j].dataObj=initInputBoxData(boxObjsArr[j],parentTdObj);}boxObjsArr[0].focus();}  }  if(boxType=='customized'){    }  if(boxType=='selectbox'){    }  if(boxType=='datepicker2'){    }  if(boxType=='textbox'){    }  if(boxType=='textareabox'){    }  if(boxType=='passwordbox'){    }  if(boxType=='file'){    }  if(boxType=='checkbox'){  isCommonFlag=false;var boxObjsArr=document.getElementsByName(realinputboxid);if(boxObjsArr==null||boxObjsArr.length==0) return;if(displayonclick=='true'){for(var j=0;j<boxObjsArr.length;j++){boxObjsArr[j].dataObj=initInputBoxData(boxObjsArr[j],parentTdObj);}boxObjsArr[0].focus();}  }  if(boxType=='popupbox'){    }  if(boxType=='richtextbox'){    }  if(isCommonFlag===true){      var boxObj=document.getElementById(realinputboxid);      if(boxObj==null) return;      if(displayonclick=='true'){boxObj.dataObj=initInputBoxData(boxObj,parentTdObj);boxObj.focus();}  }}function fillBoxValueToParentElement(boxObj,inputboxid,isChangedisplay){  var reportguid=getReportGuidByInputboxId(inputboxid);  var reportMetaDataObj=getReportMetadataObj(reportguid);  var boxMetadataObj=getInputboxMetadataObj(inputboxid);  var parentElementObj=getInputboxParentElementObjByTagName(boxObj,'TD');  if(parentElementObj==null) return;  var boxType=boxMetadataObj.getAttribute('typename');  var displayvalue='',realvalue='';  if(boxType=='combox'){  var selectboxvalue='',selectboxlabel='';var dataObjTmp=getComboxLabelValue(boxObj);if(dataObjTmp!=null){  selectboxlabel=dataObjTmp.label==null?'':dataObjTmp.label;  selectboxvalue=dataObjTmp.value==null?'':dataObjTmp.value;}realvalue=selectboxvalue;displayvalue=selectboxlabel;var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,null);if(updateDestElementObj==null){updateDestElementObj=parentElementObj;}else{parentElementObj.setAttribute('value',displayvalue);}updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='datepicker'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='radiobox'){  var selectboxvalue='',selectboxlabel='';var selectboxname=boxObj.getAttribute('name');if(selectboxname==null||selectboxname=='') return;var optionObjs=document.getElementsByName(selectboxname);if(optionObjs!=null&&optionObjs.length>0){  for(i=0,len=optionObjs.length;i<len;i=i+1){      if(optionObjs[i].checked){selectboxlabel=optionObjs[i].getAttribute('label');selectboxvalue=optionObjs[i].value; break;}  }}realvalue=selectboxvalue;displayvalue=selectboxlabel;var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,null);if(updateDestElementObj==null){updateDestElementObj=parentElementObj;}else{parentElementObj.setAttribute('value',displayvalue);}updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='customized'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='selectbox'){  var selectboxvalue='',selectboxlabel='';if(boxObj.options!=null&&boxObj.options.length>0){  var separator=boxMetadataObj.getAttribute('separator');  if(separator==null||separator==''){      selectboxvalue=boxObj.options[boxObj.options.selectedIndex].value;      selectboxlabel=boxObj.options[boxObj.options.selectedIndex].text;  }else{      for(var i=0,len=boxObj.options.length;i<len;i++){          if(boxObj.options[i].selected){              selectboxvalue+=boxObj.options[i].value+separator;              selectboxlabel+=boxObj.options[i].text+separator;          }      }      selectboxvalue=wx_rtrim(selectboxvalue,separator);selectboxlabel=wx_rtrim(selectboxlabel,separator);  }}realvalue=selectboxvalue;displayvalue=selectboxlabel;var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,null);if(updateDestElementObj==null){updateDestElementObj=parentElementObj;}else{parentElementObj.setAttribute('value',displayvalue);}updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='datepicker2'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='textbox'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='textareabox'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);boxObj.parentNode.style.display='none';boxObj.style.display='none';  }  if(boxType=='passwordbox'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='file'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='checkbox'){  var selectboxvalue='',selectboxlabel='';var selectboxname=boxObj.getAttribute('name');if(selectboxname==null||selectboxname=='') return;var optionObjs=document.getElementsByName(selectboxname);if(optionObjs!=null&&optionObjs.length>0){  var separator=boxMetadataObj.getAttribute('separator');if(separator==null||separator=='') separator=' ';  for(i=0,len=optionObjs.length;i<len;i=i+1){      if(optionObjs[i].checked){selectboxlabel+=optionObjs[i].getAttribute('label')+separator;selectboxvalue+=optionObjs[i].value+separator;}  }  selectboxlabel=wx_rtrim(selectboxlabel,separator);  selectboxvalue=wx_rtrim(selectboxvalue,separator);}realvalue=selectboxvalue;displayvalue=selectboxlabel;var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,null);if(updateDestElementObj==null){updateDestElementObj=parentElementObj;}else{parentElementObj.setAttribute('value',displayvalue);}updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='popupbox'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(boxType=='richtextbox'){    realvalue=boxObj.value; displayvalue=boxObj.value;  if(displayvalue==null) displayvalue=''; if(realvalue==null) realvalue='';  var updateDestElementObj=getUpdateColDestObj(parentElementObj,reportguid,parentElementObj);  updateDestElementObj.setAttribute('value',realvalue);  }  if(isChangedisplay===true){      if(displayvalue==null) displayvalue='';      var formatemplate=boxMetadataObj.getAttribute('formatemplate');      if(formatemplate!=null&&formatemplate!='')      {          displayvalue=getEditable2ColRealValueByFormatemplate(parentElementObj,reportguid,formatemplate,boxMetadataObj.getAttribute('formatemplate_dyncols'),displayvalue);      }      setColDisplayValueToEditable2Td(parentElementObj,displayvalue);  }}